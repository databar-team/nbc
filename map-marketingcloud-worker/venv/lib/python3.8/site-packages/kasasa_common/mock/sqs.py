import json


class MockSQSMessage:
    def __init__(self, message):
        self.body = json.dumps({
            "Type": "Notification",
            "MessageId": "junk",
            "TopicArn": "junk",
            "Subject": "Amazon S3 Notification",
            "Message": message,
            "Timestamp": "junk",
            "SignatureVersion": "1",
            "Signature": "junk",
            "SigningCertURL": "junk",
            "UnsubscribeURL": "junk"
        })

    def delete(self):
        pass


class MockSQS:

    def __init__(self, messages=tuple()):
        self.messages = [MockSQSMessage(msg) for msg in messages]

    def receive_messages(self, **kwargs):
        if kwargs.get('messages', ()):
            return kwargs.get('messages')
        elif getattr(self, 'messages') is None:
            return ()
        retval = self.messages.copy()
        self.messages = None
        return retval
